<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Your business</title>
    <link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
          crossorigin="anonymous">
    <link href="/css/styles.css" rel="stylesheet">
</head>
<body class="bodyBusiness">
    <div th:replace="/main/CustomNavbar.html"></div>

    <div class="info-container">
        <div class="info-block-head">
            <h3>Your Business Information</h3>
        </div>
        <div class="info-block-head">Information Here<br>Information Here<br>Information Here<br>Information Here<br></div>
    </div>

    <div class="info-container2">
        <div class="info-block-head">
            <h3>Your Services</h3>
        </div>
        <div class="info-block2">
            <a th:href="@{/servicio/addServicio}" class="btn-add">Add Servicio</a>
            <p align="right">
                <label for="filterBy">Filter by:</label>
				<select id="filterBy" name="filterBy">
				    <option value="all">All Services</option>
				    <option value="realizados">Completed Services</option>
				    <option value="asignados_no_realizados">Assigned but Uncompleted Services</option>
				    <option value="no_asignados">Unassigned Services</option>
				</select>

                <br>
                <label for="filterByProFamily">Filter by Profesional Family:</label>
				<select id="filterByProFamily" name="filterByProFamily">
				    <option value="none">None</option>
				    <th:block th:each="family : ${profesionalFamilies}">
				        <option th:value="${family.id}" th:text="${family.name}">Family Name</option>
				    </th:block>
				</select>

            </p>
            <table class="tableBusiness">
                <thead>
                    <tr>
                    	<th>Title</th>
                    	<th>Description</th>
                    	<th>ProFamily</th>
                        <th>Comment</th>
                        <th>Valoration</th>
                        <th>Finished</th>
                        <th>Rate</th>
                        <th>Edit</th>
                        <th>Delete</th>
                    </tr>
                </thead>
    <!-- SERVICIOS REALIZADOS -->
    <tbody id="serviceTableBody" th:if="${filterBy == 'realizados'}">
        <tr th:each="service : ${servicio}" th:if="${service.finished == 1}">
        <td th:hidden="${service.id}"></td>
        <td th:text="${service.title}"></td>
        <td th:text="${service.description}"></td>
        <td th:text="${service.proFamilyId.name}"></td>
        <td th:text="${service.comment}"></td>
        <td th:text="${service.valoration}"></td>
        <td th:text="${service.finished == 1 ? 'Sí' : 'No'}"></td>
        <td>
            	<form th:action="@{'/servicio/rateServicio/' + ${service.id}}" method="get">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/estrella.png" alt="Star img" width="30px">
                    </button>
                </form>
            </td>
            <td>
            	<form th:action="@{'/servicio/editServicio/' + ${service.id}}" method="get">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/edit.png" alt="Edit img" width="30px">
                    </button>
                </form>
            </td>
            <td>
                <form th:action="@{'/servicio/deleteServicio/' + ${service.id}}" method="post"
                      onsubmit="return confirm('¿Estás seguro que quieres cambiar su estado?');">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/delete.png" alt="Edit img" width="30px">
                    </button>
                </form>
            </td>
        </tr>
    </tbody>
    <!-- ASIGNADOS PERO NO REALIZADOS -->
    <tbody id="serviceTableBody" th:if="${filterBy == 'asignados_no_realizados'}">
        <tr th:each="service : ${servicio}" th:if="${service.studentId != null} && ${service.student}" >
        <td th:hidden="${service.id}"></td>
        <td th:text="${service.title}"></td>
        <td th:text="${service.description}"></td>
        <td th:text="${service.profesionalFamilyId.name}"></td>
        <td th:text="${service.comment}"></td>
        <td th:text="${service.valoration}"></td>
        <td th:text="${service.finished == 1 ? 'Sí' : 'No'}"></td>
        <td>
            	<form th:action="@{'/servicio/rateServicio/' + ${service.id}}" method="get">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/estrella.png" alt="Star img" width="30px">
                    </button>
                </form>
            </td>
            <td>
            	<form th:action="@{'/servicio/editServicio/' + ${service.id}}" method="get">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/edit.png" alt="Edit img" width="30px">
                    </button>
                </form>
            </td>
            <td>
                <form th:action="@{'/servicio/deleteServicio/' + ${service.id}}" method="post"
                      onsubmit="return confirm('¿Estás seguro que quieres cambiar su estado?');">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/delete.png" alt="Edit img" width="30px">
                    </button>
                </form>
            </td>
          </tr>
    </tbody>
    <!-- NO ASIGNADOS -->
    <tbody id="serviceTableBody">
        <tr th:each="service : ${servicio}" th:if="${service.studentId == null}">
            <td th:hidden="${service.id}"></td>
            <td th:text="${service.title}"></td>
            <td th:text="${service.description}"></td>
            <td th:text="${service.profesionalFamilyId.name}"></td>
            <td th:text="${service.comment}"></td>
            <td th:text="${service.valoration}"></td>
             <td>
			    <img th:if="${service.finished == 1}" src="/imgs/tick.png" alt="Sí" width="30px" />
			    <img th:if="${service.finished != 1}" src="/imgs/cross.png" alt="No" width="30px" />
			</td>
            <td>
            	<form th:action="@{'/servicio/rateServicio/' + ${service.id}}" method="get">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/estrella.png" alt="Star img" width="30px">
                    </button>
                </form>
            </td>
            <td>
            	<form th:action="@{'/servicio/editServicio/' + ${service.id}}" method="get">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/edit.png" alt="Edit img" width="30px">
                    </button>
                </form>
            </td>
            <td>
                <form th:action="@{'/servicio/deleteServicio/' + ${service.id}}" method="post"
                      onsubmit="return confirm('¿Estás seguro que quieres cambiar su estado?');">
                    <button type="submit" class="btn btn-link p-0 m-0">
                        <img src="/imgs/delete.png" alt="Edit img" width="30px">
                    </button>
                </form>
            </td>
        </tr>
    </tbody>
</table>

        
      </table>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</body>
</html>
